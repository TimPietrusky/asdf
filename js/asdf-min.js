(function(){var b;Asdf=function(){b=this;var c=this.getButtons();this.dom={};this.dom.body=document.getElementsByTagName("body")[0];this.dom.wrapper=document.getElementsByClassName("wrapper")[0];this.dom.controls=this.getId("controls");this.dom.spacebar=this.getId("space");this.dom.esc=this.getId("esc");this.dom.one=this.getId("one");this.dom.two=this.getId("two");this.dom.three=this.getId("three");this.dom.up=this.getId("up");this.dom.down=this.getId("down");this.dom.message=this.getId("message");this.dom.status=this.getId("status");this.dom.score=this.getId("score");this.dom.level=this.getId("level");this.dom.tweet=this.getId("tweet");this.dom.tweetlink=this.getId("tweet-link");this.dom.noclick=this.getId("noclick");this.dom.info=this.getId("info");this.dom.mode=this.getId("mode");this.dom.modetext=this.getId("mode-text");this.o={};this.o.elements={};this.o.elements.a=c[0];this.o.elements.s=c[1];this.o.elements.d=c[2];this.o.elements.f=c[3];this.o.types=["a","s","d","f"];this.o.audio=[];this.o.volume=0.15;this.o.wave=[];this.o.data=[];this.o.data.a=[];this.o.data.s=[];this.o.data.d=[];this.o.data.f=[];this.o.list=[];this.o.count=0;this.o.started=false;this.dom.body.onkeydown=this.keyboard.receive;this.dom.body.onkeyup=this.keyboard.receive;this.dom.body.onclick=this.clickizr;Events.subscribe("a",this.dong);Events.subscribe("s",this.dong);Events.subscribe("d",this.dong);Events.subscribe("f",this.dong);Events.subscribe("a-triggered",this.listener);Events.subscribe("s-triggered",this.listener);Events.subscribe("d-triggered",this.listener);Events.subscribe("f-triggered",this.listener);Events.subscribe("mode",this.mode.change);b.audio.init();this.dom.body.focus()};Asdf.prototype.getId=function(c){return document.getElementById(c)};Asdf.prototype.mode={number:1,change:function(){b.mode.number=arguments[0];if(b.o.started){b.o.started=false;b.game.live=false;b.gogogo()}if(b.mode.number==1){b.mode.switchMode("normal");b.dom.status.style.display="block";for(i=0;i<b.o.types.length;i++){var c=b.o.types[i];b.o.elements[c].style.color="";b.o.elements[c].style.textShadow=""}}if(b.mode.number==2){b.mode.switchMode("not easy");b.dom.status.style.display="block";for(i=0;i<b.o.types.length;i++){var c=b.o.types[i];b.o.elements[c].style.color="";b.o.elements[c].style.textShadow=""}}if(b.mode.number==3){b.mode.switchMode("hell");b.dom.status.style.display="none";for(i=0;i<b.o.types.length;i++){var c=b.o.types[i];b.o.elements[c].style.color="transparent";b.o.elements[c].style.textShadow="none"}}},getMode:function(){switch(b.mode.number){case 1:return"normal";break;case 2:return"not easy";break;case 3:return"hell";break;default:}},switchMode:function(c){b.dom.modetext.innerHTML=c;b.dom.modetext.className="active";b.dom.body.className=c.split(" ").join("");setTimeout(function(){b.dom.modetext.className=""},250)},getLevel:function(){var c=b.o.list.length;switch(b.mode.number){case 2:c=c/2;break;case 3:c=c/2;break;default:}return c},getScore:function(){var c=parseInt(b.dom.score.innerHTML)+(b.o.list.length*b.o.list.length);switch(b.mode.number){case 2:c=parseInt(c*1.5);break;case 3:c=parseInt(c*3);break;default:}return c}};Asdf.prototype.message={show:function(d){b.message.hide();if(d.type=="lose"){b.dom.message.className+=" lose";b.dom.controls.className+=" inactive";b.dom.wrapper.className+=" inactive";b.dom.body.className+=" inactive";var c=b.o.list[b.o.count],e=(parseInt(b.dom.level.innerHTML)-1);b.dom.message.innerHTML='<div class="container"><h2>GAME OVER</h2><p><b>score</b> <span class="info-style">'+b.dom.score.innerHTML+'</span> <b>level</b> <span class="info-style">'+e+'</span><b>mode</b> <span class="info-style">'+b.mode.getMode()+'</span></p><hr><p><a id="tweet-link" href="http://twitter.com/share?text=Can+you+beat+my+score+'+b.dom.score.innerHTML+"+on+level+"+e+"+("+b.mode.getMode()+')?&hashtags=asdf&url=http://timpietrusky.github.com/asdf" target="_blank"><button id="tweet" class="key">t</button> Tweet your score</a></p><hr class="small"><p><button class="key '+c+'">'+c+'</button> was the next key,</p><p>but you pushed <button class="key '+d.key+'"">'+d.key+'</button> <b class="smiley">D:</b></p></div>'}if(d.type=="win"){b.dom.message.className+=" win";b.dom.message.innerHTML='<div class="container"><h1>LEVEL COMPLETED</h1></div>'}if(d.type=="levelmode"){b.dom.message.className+=" levelmode";b.dom.message.innerHTML='<div class="container"><h1>'+d.text+"</h1></div>"}b.dom.message.className+=" active"},hide:function(){b.dom.message.className="";b.dom.controls.className="";b.dom.body.className=b.dom.body.className.replace("inactive","");b.dom.wrapper.className="wrapper"}};Asdf.prototype.audio={init:function(){var d=5000;while(d<15000){b.o.data.a[d++]=64+Math.round(32*(Math.cos(d*d/2000)+Math.sin(d*d/4000)));b.o.data.a[d++]=64+Math.round(32*(Math.cos(d*d/2000)+Math.sin(d*d/4000)))}d=10000;while(d<20000){b.o.data.s[d++]=Math.round(Math.cos(d%100)*5);b.o.data.s[d++]=Math.round(Math.cos(d%100)*5)}d=1000;while(d<15000){b.o.data.d[d++]=228+Math.round(87*Math.cos(d/20));b.o.data.d[d++]=128+Math.round(97*Math.cos(d/80))}d=8000;while(d<20000){b.o.data.f[d++]=Math.abs(250-(d%180));b.o.data.f[d++]=Math.abs(250-(d%180))}for(var c=0;c<b.o.types.length;c++){var e=b.o.types[c];b.o.wave[e]=new RIFFWAVE();b.o.wave[e].header.sampleRate=44100;b.o.wave[e].header.numChannels=2;b.o.wave[e].Make(b.o.data[e]);b.o.audio[e]=new Audio();b.o.audio[e].volume=b.o.volume;b.o.audio[e].src=b.o.wave[e].dataURI}},play:function(c){if(b.o.volume>0){b.o.audio[c].currentTime=0;b.o.audio[c].play()}},volumeUp:function(){if(b.o.volume<0.92){b.o.volume+=0.05;b.audio.changeVolume()}},volumeDown:function(){if(b.o.volume>0){b.o.volume-=0.05;if(b.o.volume<=0){b.o.volume=0}b.audio.changeVolume()}},changeVolume:function(){for(var c=0;c<b.o.types.length;c++){var d=b.o.types[c];b.o.audio[d].volume=b.o.volume}}};Asdf.prototype.keyboard={receive:function(c){if(c.keyCode==32){c.preventDefault();if(c.type=="keydown"){b.gogogo()}b.keyboard.pushState(c,b.dom.spacebar)}if(c.keyCode==27){if(c.type=="keydown"){b.game.reset();b.game.live=false}b.keyboard.pushState(c,b.dom.esc)}if(c.keyCode==37){if(c.type=="keydown"){b.audio.volumeDown()}b.keyboard.pushState(c,b.dom.up)}if(c.keyCode==39){if(c.type=="keydown"){b.audio.volumeUp()}b.keyboard.pushState(c,b.dom.down)}if(c.keyCode==49){if(b.dom.mode.mode[0].checked){Events.publish("mode",[1])}b.dom.mode.mode[0].checked=true;b.keyboard.pushState(c,b.dom.one)}if(c.keyCode==50){if(b.dom.mode.mode[1].checked){Events.publish("mode",[2])}b.dom.mode.mode[1].checked=true;b.keyboard.pushState(c,b.dom.two)}if(c.keyCode==51){if(b.dom.mode.mode[2].checked){Events.publish("mode",[3])}b.dom.mode.mode[2].checked=true;b.keyboard.pushState(c,b.dom.three)}if(c.keyCode==97||c.keyCode==65){Events.publish("a",["a",c.type])}if(c.keyCode==115||c.keyCode==83){Events.publish("s",["s",c.type])}if(c.keyCode==100||c.keyCode==68){Events.publish("d",["d",c.type])}if(c.keyCode==102||c.keyCode==70){Events.publish("f",["f",c.type])}if(c.keyCode==84){if(c.type=="keydown"){b.dom.tweetlink=b.getId("tweet-link");if(b.dom.tweetlink!=undefined){window.open(b.dom.tweetlink.href,"asdf-tweet-your-score")}}}},pushState:function(d,c){if(d.type=="keydown"){c.className=c.className.replace("active","");c.className+=" active"}else{c.className=c.className.replace("active","")}}};Asdf.prototype.clickizr=function(c){};Asdf.prototype.getButtons=function(c){return document.getElementById("gaming-buttons").getElementsByTagName("button")};Asdf.prototype.dong=function(){var c=arguments[0],d=arguments[1];if(d=="keyup"){b.o.elements[c].className=""}else{b.o.elements[c].className="active";b.audio.play(c);Events.publish(c+"-triggered",[c,b.o.count])}};Asdf.prototype.gogogo=function(){if(!b.game.live){b.game.live=true;b.game.reset();b.dom.info.className="active";b.game.next()}};Asdf.prototype.addElement=function(){if(b.mode.number>=2){b.o.list.push(b.o.types[(Math.floor(Math.random()*b.o.types.length))])}b.o.list.push(b.o.types[(Math.floor(Math.random()*b.o.types.length))])};Asdf.prototype.game={count:0,live:false,reset:function(){count=0;b.o.started=false;b.o.list=[];b.dom.info.className="";b.game.updateScore();b.dom.level.innerHTML=0;b.message.hide();b.game.status.hide()},next:function(){count=0;b.addElement();b.message.show({type:"levelmode",text:"LEVEL "+b.mode.getLevel()+' <span class="info-style-2">'+b.mode.getMode()+"</span>"});b.game.updateLevel();setTimeout(function(){b.trigger(b.o.list,count)},350)},won:function(){b.o.started=false;b.game.updateScore();b.game.status.hide();b.o.count=0;b.message.show({type:"win"});setTimeout(function(){b.game.next()},750)},lose:function(c){b.message.show({type:"lose",key:c});b.game.live=false;b.o.started=false;b.o.count=0},updateScore:function(){var c=8,d=b.mode.getScore();if(b.o.list.length==0){d=0}c-=d.toString().length;if(c>0){d=new Array(c+(/\./.test(d)?2:1)).join("0")+d}b.dom.score.innerHTML=d+"";b.dom.score.className="active";setTimeout(function(){b.dom.score.className=""},250)},updateLevel:function(){b.dom.level.innerHTML=b.mode.getLevel();if(b.o.list.length>0){b.dom.level.className="active";setTimeout(function(){b.dom.level.className=""},250)}},status:{show:function(c){b.dom.status.innerHTML=c.text;b.dom.status.className=b.dom.status.className.replace("active","");b.dom.status.className+=" active"},hide:function(){b.dom.status.className=b.dom.status.className.replace("active","")}}};Asdf.prototype.trigger=function(e,d){var c=e[d];setTimeout(function(){Events.publish(c,[c,"keydown"]);if(e[d+1]==undefined){b.o.started=true;b.message.hide();b.game.status.show({text:b.o.count+"/"+b.o.list.length});setTimeout(function(){Events.publish(c,[c,"keyup"])},250)}else{setTimeout(function(){Events.publish(c,[c,"keyup"]);if(e[d++]!=undefined){setTimeout(function(){b.trigger(e,d)},50)}else{b.o.started=true;b.message.hide();b.game.status.show({text:b.o.count+"/"+b.o.list.length})}},200)}},150)};Asdf.prototype.listener=function(c,d){var c=arguments[0],d=arguments[1];if(b.o.started){if(c==b.o.list[d]){b.o.count++;b.game.status.show({text:b.o.count+"/"+b.o.list.length});if(b.o.list[d+1]==undefined){b.game.won()}}else{b.game.lose(c)}}};function a(){if(document.readyState==="complete"){var c=new Asdf()}else{setTimeout(function(){a()},25)}}a()}).call(this);